CREATE TABLE SAILOR(
SID VARCHAR2(5),
SNAME VARCHAR2(20),
AGE NUMERIC(5),
RATING NUMERIC(5),
CONSTRAINT PK_SID_36 PRIMARY KEY(SID));

CREATE TABLE BOAT(
BID VARCHAR2(5),
BNAME VARCHAR2(20),
COLOR VARCHAR2(10),
CONSTRAINT PK_BID PRIMARY KEY(BID));

CREATE TABLE RESERVE(
BID VARCHAR2(5),
SID VARCHAR2(5),
RES_DATE DATE,
CONSTRAINT FK_BID FOREIGN KEY(BID) REFERENCES BOAT(BID),
CONSTRAINT FK_SID FOREIGN KEY(SID) REFERENCES SAILOR(SID));

INSERT INTO SAILOR VALUES('S1','TOM',50,4);
INSERT INTO SAILOR VALUES('S2','HARRY',42,3);
INSERT INTO SAILOR VALUES('S3','SAMUEL',35,5);
INSERT INTO SAILOR VALUES('S4','GARY',37,3);
INSERT INTO SAILOR VALUES('S5','BOB',62,1);

INSERT INTO BOAT VALUES('B1','TITANIC','NAVY BLUE');
INSERT INTO BOAT VALUES('B2','HARMONY','GREY');
INSERT INTO BOAT VALUES('B3','LADY BIRD','RED');
INSERT INTO BOAT VALUES('B4','OCEANIC','GREEN');
INSERT INTO BOAT VALUES('B5','OLYMPIA','MAGENTA');

INSERT INTO RESERVE VALUES('B1','S1','11-NOV-1999');
INSERT INTO RESERVE VALUES('B2','S2','30-JUN-2001');
INSERT INTO RESERVE VALUES('B3','S3','07-SEP-2000');
INSERT INTO RESERVE VALUES('B4','S1','11-NOV-1999');
INSERT INTO RESERVE VALUES('B3','S5','17-APR-2000');

SELECT SNAME FROM SAILOR S, BOAT B, RESERVE R WHERE S.SID=R.SID AND B.BID=R.BID AND COLOR='RED';

SELECT DISTINCT(SNAME) FROM SAILOR S, RESERVE R WHERE S.SID=R.SID;

SELECT DISTINCT(S.SNAME),(S.RATING+1) AS NEW_RATING FROM SAILOR S, RESERVE R1,RESERVE R2 WHERE S.SID=R1.SID AND S.SID=R2.SID AND R1.RES_DATE=R2.RES_DATE AND R1.BID<>R2.BID;

SELECT SNAME FROM SAILOR WHERE SNAME LIKE 'B%__' AND SNAME LIKE '__%B';

SELECT S.SNAME FROM SAILOR S,BOAT B,RESERVE R WHERE R.BID=B.BID AND S.SID=R.SID AND (B.COLOR='RED' OR B.COLOR='GREEN');

SELECT DISTINCT(S.SID) FROM SAILOR S, BOAT B,RESERVE R WHERE S.SID=R.SID AND B.BID=R.BID AND B.COLOR='RED' AND B.COLOR!='GREEN';

SELECT SNAME,RATING AS MAX_RATED_SAILOR FROM SAILOR WHERE RATING=(SELECT MAX(RATING) FROM SAILOR);

SELECT SNAME,AGE AS OLDEST_SAILOR FROM SAILOR WHERE AGE=(SELECT MAX(AGE) FROM SAILOR);

SELECT S.RATING AS RATING,COUNT(S.SID) AS NO_OF_VOTERS FROM SAILOR S WHERE S.AGE>18 GROUP BY S.RATING;